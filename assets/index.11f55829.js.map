{"version":3,"file":"index.11f55829.js","sources":["../../vite/modulepreload-polyfill","../../main.ts"],"sourcesContent":["const p = function polyfill() {\n    const relList = document.createElement('link').relList;\n    if (relList && relList.supports && relList.supports('modulepreload')) {\n        return;\n    }\n    for (const link of document.querySelectorAll('link[rel=\"modulepreload\"]')) {\n        processPreload(link);\n    }\n    new MutationObserver((mutations) => {\n        for (const mutation of mutations) {\n            if (mutation.type !== 'childList') {\n                continue;\n            }\n            for (const node of mutation.addedNodes) {\n                if (node.tagName === 'LINK' && node.rel === 'modulepreload')\n                    processPreload(node);\n            }\n        }\n    }).observe(document, { childList: true, subtree: true });\n    function getFetchOpts(script) {\n        const fetchOpts = {};\n        if (script.integrity)\n            fetchOpts.integrity = script.integrity;\n        if (script.referrerpolicy)\n            fetchOpts.referrerPolicy = script.referrerpolicy;\n        if (script.crossorigin === 'use-credentials')\n            fetchOpts.credentials = 'include';\n        else if (script.crossorigin === 'anonymous')\n            fetchOpts.credentials = 'omit';\n        else\n            fetchOpts.credentials = 'same-origin';\n        return fetchOpts;\n    }\n    function processPreload(link) {\n        if (link.ep)\n            // ep marker = processed\n            return;\n        link.ep = true;\n        // prepopulate the load record\n        const fetchOpts = getFetchOpts(link);\n        fetch(link.href, fetchOpts);\n    }\n};__VITE_IS_MODERN__&&p();","let db: { id: string, kw: string[], url: string, src: 'scoop' | 'winget' }[] | undefined;\n\nconst CHUNK = 20\nlet current = 0, maxsize = CHUNK;\n\nconst $: typeof document.querySelector = (sel: string) => document.querySelector(sel)\n\nconst $winget: HTMLInputElement = $('#winget')\nconst $scoop: HTMLInputElement = $('#scoop')\nconst $search: HTMLInputElement = $('#search')\nconst $result = $('#result')\nconst $template: HTMLTemplateElement = $('#result-item-template')\nconst $more: HTMLButtonElement = $('#more')\n\ncustomElements.define('result-item', class extends HTMLElement {\n  constructor() {\n    super()\n    this.attachShadow({ mode: 'open' })\n        .append($template.content.cloneNode(true))\n  }\n})\n\nlet raf = 0, cursor = 0;\n\nfunction reset() {\n  current = cursor = 0\n  maxsize = CHUNK\n  $result.innerHTML = ''\n  $more.disabled = true\n}\n\nfunction h(tag: string, attrs: object) {\n  return Object.assign(document.createElement(tag), attrs);\n}\n\nasync function refresh() {\n  if (current < maxsize) {\n    current += CHUNK\n    raf = requestAnimationFrame(refresh)\n  }\n\n  let i = 0\n  const winget = $winget.checked, scoop = $scoop.checked\n  const hint = $search.value.toLowerCase().split(/\\s+/)\n  while (cursor < db.length && i < CHUNK) {\n    let { id, kw, url, src } = db[cursor++]\n    if (src === \"scoop\" && !scoop) continue;\n    if (src === \"winget\" && !winget) continue;\n    if (hint.some(k => kw.some(e => e.toLowerCase().includes(k)))) {\n      let dom = document.createElement('result-item')\n      dom.append(\n        h('span', { slot: 'id', textContent: id }),\n        h('span', { slot: 'kw', textContent: kw.join(',') }),\n        h('span', { slot: 'src', textContent: src }),\n        h('a', { slot: 'url', textContent: url, href: url }),\n      )\n      $result.append(dom)\n      i++\n    }\n  }\n\n  $more.disabled = !(cursor < db.length)\n}\n\nfunction search() {\n  reset()\n  cancelAnimationFrame(raf)\n  raf = requestAnimationFrame(refresh)\n}\n\nfunction more() {\n  maxsize += CHUNK\n  raf = requestAnimationFrame(refresh)\n}\n\nasync function main() {\n  $search.disabled = true\n\n  db = await fetch(\"db.json\").then(r => r.json())\n\n  $search.disabled = false\n  $search.placeholder = \"search here\"\n  $search.focus()\n\n  $search.addEventListener('input', search)\n\n  $more.addEventListener('click', more)\n  $winget.addEventListener('change', search)\n  $scoop.addEventListener('change', search)\n}\n\nmain()\n\nif (import.meta.env.DEV)\n  navigator.serviceWorker?.getRegistrations().then(r => {\n    r.forEach(e => e.unregister())\n  })\n"],"names":["relList","document","createElement","supports","link","querySelectorAll","MutationObserver","mutations","mutation","type","node","addedNodes","tagName","rel","observe","childList","subtree","ep","fetchOpts","script","integrity","referrerpolicy","referrerPolicy","crossorigin","credentials","getFetchOpts","href","p","db","current","maxsize","$","sel","querySelector","$winget","$scoop","$search","$result","$template","$more","customElements","define","HTMLElement","constructor","attachShadow","mode","append","content","cloneNode","raf","cursor","tag","attrs","Object","assign","async","requestAnimationFrame","refresh","i","winget","checked","scoop","hint","value","toLowerCase","split","length","id","kw","url","src","some","e","includes","k","dom","h","slot","textContent","join","disabled","innerHTML","fetch","then","r","json","placeholder","focus","addEventListener","search","more","main"],"mappings":"CAAU,iBACAA,EAAUC,SAASC,cAAc,QAAQF,aAC3CA,GAAWA,EAAQG,UAAYH,EAAQG,SAAS,6BAGzCC,KAAQH,SAASI,iBAAiB,+BAC1BD,OAEfE,kBAAkBC,cACPC,KAAYD,KACG,cAAlBC,EAASC,eAGFC,KAAQF,EAASG,WACH,SAAjBD,EAAKE,SAAmC,kBAAbF,EAAKG,OACjBH,MAG5BI,QAAQb,SAAU,CAAEc,WAAW,EAAMC,SAAS,eAezBZ,MAChBA,EAAKa,YAGJA,IAAK,QAEJC,WApBYC,SACZD,EAAY,UACdC,EAAOC,cACGA,UAAYD,EAAOC,WAC7BD,EAAOE,mBACGC,eAAiBH,EAAOE,gBACX,oBAAvBF,EAAOI,cACGC,YAAc,UACI,cAAvBL,EAAOI,cACFC,YAAc,SAEdA,YAAc,cACrBN,EAQWO,CAAarB,SACzBA,EAAKsB,KAAMR,IAEvBS,GC1CF,IAAIC,EAGJ,IAAIC,EAAU,EAAGC,EADH,GAGd,MAAMC,EAAoCC,GAAgB/B,SAASgC,cAAcD,GAE3EE,EAA4BH,EAAE,WAC9BI,EAA2BJ,EAAE,UAC7BK,EAA4BL,EAAE,WAC9BM,EAAUN,EAAE,WACZO,EAAiCP,EAAE,yBACnCQ,EAA2BR,EAAE,SAEnCS,eAAeC,OAAO,cAAe,cAAcC,YACjDC,2BAEOC,aAAa,CAAEC,KAAM,SACrBC,OAAOR,EAAUS,QAAQC,WAAU,OAI5C,IAAIC,EAAM,EAAGC,EAAS,EAStB,WAAWC,EAAaC,UACfC,OAAOC,OAAOrD,SAASC,cAAciD,GAAMC,GAGpDG,mBACM1B,EAAUC,OAlCF,KAoCJ0B,sBAAsBC,QAG1BC,EAAI,QACFC,EAASzB,EAAQ0B,QAASC,EAAQ1B,EAAOyB,QACzCE,EAAO1B,EAAQ2B,MAAMC,cAAcC,MAAM,YACxCf,EAAStB,EAAGsC,QAAUR,EA1CjB,IA0C4B,KAClCS,GAAEA,KAAIC,MAAIC,MAAKC,GAAQ1C,EAAGsB,SAClB,UAARoB,GAAoBT,MACZ,WAARS,GAAqBX,IACrBG,EAAKS,SAAUH,EAAGG,SAAUC,EAAER,cAAcS,SAASC,QAAM,KACzDC,EAAM1E,SAASC,cAAc,iBAC7B4C,OACF8B,EAAE,OAAQ,CAAEC,KAAM,KAAMC,YAAaX,IACrCS,EAAE,OAAQ,CAAEC,KAAM,KAAMC,YAAaV,EAAGW,KAAK,OAC7CH,EAAE,OAAQ,CAAEC,KAAM,MAAOC,YAAaR,IACtCM,EAAE,IAAK,CAAEC,KAAM,MAAOC,YAAaT,EAAK3C,KAAM2C,OAExCvB,OAAO6B,UAKbK,aAAsBpD,EAAGsC,QAGjC,eAvCYhB,EAAS,IAvBP,KAyBJ+B,UAAY,KACdD,UAAW,uBAsCI/B,KACfO,sBAAsBC,GAG9B,gBApEc,KAsEND,sBAAsBC,IAG9BF,mBACUyB,UAAW,UAERE,MAAM,WAAWC,SAAUC,EAAEC,WAEhCL,UAAW,IACXM,YAAc,gBACdC,UAEAC,iBAAiB,QAASC,KAE5BD,iBAAiB,QAASE,KACxBF,iBAAiB,SAAUC,KAC5BD,iBAAiB,SAAUC,GAGpCE"}