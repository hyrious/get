{"version":3,"file":"index.7a13796b.js","sources":["../../vite/modulepreload-polyfill","../../main.ts"],"sourcesContent":["const p = function polyfill() {\n    const relList = document.createElement('link').relList;\n    if (relList && relList.supports && relList.supports('modulepreload')) {\n        return;\n    }\n    for (const link of document.querySelectorAll('link[rel=\"modulepreload\"]')) {\n        processPreload(link);\n    }\n    new MutationObserver((mutations) => {\n        for (const mutation of mutations) {\n            if (mutation.type !== 'childList') {\n                continue;\n            }\n            for (const node of mutation.addedNodes) {\n                if (node.tagName === 'LINK' && node.rel === 'modulepreload')\n                    processPreload(node);\n            }\n        }\n    }).observe(document, { childList: true, subtree: true });\n    function getFetchOpts(script) {\n        const fetchOpts = {};\n        if (script.integrity)\n            fetchOpts.integrity = script.integrity;\n        if (script.referrerpolicy)\n            fetchOpts.referrerPolicy = script.referrerpolicy;\n        if (script.crossorigin === 'use-credentials')\n            fetchOpts.credentials = 'include';\n        else if (script.crossorigin === 'anonymous')\n            fetchOpts.credentials = 'omit';\n        else\n            fetchOpts.credentials = 'same-origin';\n        return fetchOpts;\n    }\n    function processPreload(link) {\n        if (link.ep)\n            // ep marker = processed\n            return;\n        link.ep = true;\n        // prepopulate the load record\n        const fetchOpts = getFetchOpts(link);\n        fetch(link.href, fetchOpts);\n    }\n};__VITE_IS_MODERN__&&p();","let db: { id: string, kw: string[], url: string, src: 'scoop' | 'winget' }[] | undefined;\n\nconst CHUNK = 20\nlet current = 0, maxsize = CHUNK;\n\nconst $: typeof document.querySelector = (sel: string) => document.querySelector(sel)\n\nconst $winget: HTMLInputElement = $('#winget')\nconst $scoop: HTMLInputElement = $('#scoop')\nconst $search: HTMLInputElement = $('#search')\nconst $result = $('#result')\nconst $template: HTMLTemplateElement = $('#result-item-template')\nconst $more: HTMLButtonElement = $('#more')\n\ncustomElements.define('result-item', class extends HTMLElement {\n  constructor() {\n    super()\n    this.attachShadow({ mode: 'open' })\n        .append($template.content.cloneNode(true))\n  }\n})\n\nlet raf = 0, cursor = 0;\n\nfunction reset() {\n  current = cursor = 0\n  maxsize = CHUNK\n  $result.innerHTML = ''\n  $more.disabled = true\n}\n\nfunction h(tag: string, attrs: object) {\n  return Object.assign(document.createElement(tag), attrs);\n}\n\nasync function refresh() {\n  if (current < maxsize) {\n    current += CHUNK\n    raf = requestAnimationFrame(refresh)\n  }\n\n  let i = 0\n  const winget = $winget.checked, scoop = $scoop.checked\n  const hint = $search.value.toLowerCase().split(/\\s+/)\n  while (cursor < db.length && i < CHUNK) {\n    let { id, kw, url, src } = db[cursor++]\n    if (src === \"scoop\" && !scoop) continue;\n    if (src === \"winget\" && !winget) continue;\n    if (hint.some(k => kw.some(e => e.toLowerCase().includes(k)))) {\n      let dom = document.createElement('result-item')\n      dom.append(\n        h('span', { slot: 'id', textContent: id }),\n        h('span', { slot: 'kw', textContent: kw.join(',') }),\n        h('span', { slot: 'src', textContent: src }),\n        h('a', { slot: 'url', textContent: url, href: url }),\n      )\n      $result.append(dom)\n      i++\n    }\n  }\n\n  $more.disabled = !(cursor < db.length)\n}\n\nfunction search() {\n  reset()\n  cancelAnimationFrame(raf)\n  raf = requestAnimationFrame(refresh)\n}\n\nfunction more() {\n  maxsize += CHUNK\n  raf = requestAnimationFrame(refresh)\n}\n\nasync function main() {\n  $search.disabled = true\n\n  db = await fetch(\"db.json\").then(r => r.json())\n\n  $search.disabled = false\n  $search.placeholder = \"search here\"\n  $search.focus()\n\n  $search.addEventListener('input', search)\n\n  $more.addEventListener('click', more)\n  $winget.addEventListener('change', search)\n  $scoop.addEventListener('change', search)\n}\n\nmain()\n\nif (import.meta.env.DEV)\n  navigator.serviceWorker?.getRegistrations().then(r => {\n    r.forEach(e => e.unregister())\n  })\n"],"names":["p","relList","link","processPreload","mutations","mutation","node","getFetchOpts","script","fetchOpts","db","CHUNK","current","maxsize","$","sel","$winget","$scoop","$search","$result","$template","$more","raf","cursor","reset","h","tag","attrs","refresh","i","winget","scoop","hint","id","kw","url","src","k","e","dom","search","more","main","r"],"mappings":"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"}