{"version":3,"file":"index.cc0720df.js","sources":["../../vite/modulepreload-polyfill","../../main.ts"],"sourcesContent":["const p = function polyfill() {\n    const relList = document.createElement('link').relList;\n    if (relList && relList.supports && relList.supports('modulepreload')) {\n        return;\n    }\n    for (const link of document.querySelectorAll('link[rel=\"modulepreload\"]')) {\n        processPreload(link);\n    }\n    new MutationObserver((mutations) => {\n        for (const mutation of mutations) {\n            if (mutation.type !== 'childList') {\n                continue;\n            }\n            for (const node of mutation.addedNodes) {\n                if (node.tagName === 'LINK' && node.rel === 'modulepreload')\n                    processPreload(node);\n            }\n        }\n    }).observe(document, { childList: true, subtree: true });\n    function getFetchOpts(script) {\n        const fetchOpts = {};\n        if (script.integrity)\n            fetchOpts.integrity = script.integrity;\n        if (script.referrerpolicy)\n            fetchOpts.referrerPolicy = script.referrerpolicy;\n        if (script.crossorigin === 'use-credentials')\n            fetchOpts.credentials = 'include';\n        else if (script.crossorigin === 'anonymous')\n            fetchOpts.credentials = 'omit';\n        else\n            fetchOpts.credentials = 'same-origin';\n        return fetchOpts;\n    }\n    function processPreload(link) {\n        if (link.ep)\n            // ep marker = processed\n            return;\n        link.ep = true;\n        // prepopulate the load record\n        const fetchOpts = getFetchOpts(link);\n        fetch(link.href, fetchOpts);\n    }\n};__VITE_IS_MODERN__&&p();","let db: { id: string, kw: string[], url: string, src: 'scoop' | 'winget' }[] | undefined;\n\nconst CHUNK = 20\nlet current = 0, maxsize = CHUNK;\n\nconst $: typeof document.querySelector = (sel: string) => document.querySelector(sel)\n\nconst $search: HTMLInputElement = $('#search')\nconst $result = $('#result')\nconst $template: HTMLTemplateElement = $('#result-item-template')\nconst $more: HTMLButtonElement = $('#more')\n\ncustomElements.define('result-item', class extends HTMLElement {\n  constructor() {\n    super()\n    this.attachShadow({ mode: 'open' })\n        .append($template.content.cloneNode(true))\n  }\n})\n\nlet raf = 0, cursor = 0;\n\nfunction reset() {\n  current = cursor = 0\n  maxsize = CHUNK\n  $result.innerHTML = ''\n  $more.disabled = true\n}\n\nfunction h(tag: string, attrs: object) {\n  return Object.assign(document.createElement(tag), attrs);\n}\n\nasync function refresh() {\n  if (current < maxsize) {\n    current += CHUNK\n    raf = requestAnimationFrame(refresh)\n  }\n\n  let i = 0\n  const hint = $search.value.toLowerCase()\n  while (cursor < db.length && i < CHUNK) {\n    let { id, kw, url, src } = db[cursor++]\n    if (kw.some(e => e.toLowerCase().includes(hint))) {\n      let dom = document.createElement('result-item')\n      dom.append(\n        h('span', { slot: 'id', textContent: id }),\n        h('span', { slot: 'kw', textContent: kw.join(',') }),\n        h('span', { slot: 'src', textContent: src }),\n        h('a', { slot: 'url', textContent: url, href: url }),\n      )\n      $result.append(dom)\n      i++\n    }\n  }\n\n  $more.disabled = !(cursor < db.length)\n}\n\nfunction search() {\n  reset()\n  cancelAnimationFrame(raf)\n  raf = requestAnimationFrame(refresh)\n}\n\nfunction more() {\n  maxsize += CHUNK\n  raf = requestAnimationFrame(refresh)\n}\n\nasync function main() {\n  db = await fetch(\"db.json\").then(r => r.json())\n\n  $search.placeholder = \"type keywords here\"\n  $search.focus()\n\n  $search.addEventListener('input', search)\n\n  $more.addEventListener('click', more)\n}\n\nmain()\n\nif (import.meta.env.PROD)\n  navigator.serviceWorker?.getRegistrations().then(r => {\n    r.forEach(e => e.unregister())\n  })\n"],"names":["relList","document","createElement","supports","link","querySelectorAll","MutationObserver","mutations","mutation","type","node","addedNodes","tagName","rel","observe","childList","subtree","ep","fetchOpts","script","integrity","referrerpolicy","referrerPolicy","crossorigin","credentials","getFetchOpts","href","p","db","current","maxsize","$","sel","querySelector","$search","$result","$template","$more","customElements","define","HTMLElement","constructor","attachShadow","mode","append","content","cloneNode","raf","cursor","tag","attrs","Object","assign","async","requestAnimationFrame","refresh","i","hint","value","toLowerCase","length","id","kw","url","src","some","e","includes","dom","h","slot","textContent","join","disabled","innerHTML","fetch","then","r","json","placeholder","focus","addEventListener","search","more","main","serviceWorker","getRegistrations","forEach","unregister"],"mappings":"AAAA,OAAU,iBACAA,EAAUC,SAASC,cAAc,QAAQF,aAC3CA,GAAWA,EAAQG,UAAYH,EAAQG,SAAS,6BAGzCC,KAAQH,SAASI,iBAAiB,+BAC1BD,OAEfE,kBAAkBC,cACPC,KAAYD,KACG,cAAlBC,EAASC,eAGFC,KAAQF,EAASG,WACH,SAAjBD,EAAKE,SAAmC,kBAAbF,EAAKG,OACjBH,MAG5BI,QAAQb,SAAU,CAAEc,WAAW,EAAMC,SAAS,eAezBZ,MAChBA,EAAKa,YAGJA,IAAK,QAEJC,WApBYC,SACZD,EAAY,UACdC,EAAOC,cACGA,UAAYD,EAAOC,WAC7BD,EAAOE,mBACGC,eAAiBH,EAAOE,gBACX,oBAAvBF,EAAOI,cACGC,YAAc,UACI,cAAvBL,EAAOI,cACFC,YAAc,SAEdA,YAAc,cACrBN,EAQWO,CAAarB,SACzBA,EAAKsB,KAAMR,IAEvBS,GC1CF,IAAIC,EAGJ,IAAIC,EAAU,EAAGC,EADH,GAGd,MAAMC,EAAoCC,GAAgB/B,SAASgC,cAAcD,GAE3EE,EAA4BH,EAAE,WAC9BI,EAAUJ,EAAE,WACZK,EAAiCL,EAAE,yBACnCM,EAA2BN,EAAE,SAEnCO,eAAeC,OAAO,cAAe,cAAcC,YACjDC,2BAEOC,aAAa,CAAEC,KAAM,SACrBC,OAAOR,EAAUS,QAAQC,WAAU,OAI5C,IAAIC,EAAM,EAAGC,EAAS,EAStB,WAAWC,EAAaC,UACfC,OAAOC,OAAOnD,SAASC,cAAc+C,GAAMC,GAGpDG,mBACMxB,EAAUC,OAhCF,KAkCJwB,sBAAsBC,QAG1BC,EAAI,QACFC,EAAOvB,EAAQwB,MAAMC,mBACpBX,EAASpB,EAAGgC,QAAUJ,EAvCjB,IAuC4B,KAClCK,GAAEA,KAAIC,MAAIC,MAAKC,GAAQpC,EAAGoB,QAC1Bc,EAAGG,SAAUC,EAAEP,cAAcQ,SAASV,KAAQ,KAC5CW,EAAMnE,SAASC,cAAc,iBAC7B0C,OACFyB,EAAE,OAAQ,CAAEC,KAAM,KAAMC,YAAaV,IACrCQ,EAAE,OAAQ,CAAEC,KAAM,KAAMC,YAAaT,EAAGU,KAAK,OAC7CH,EAAE,OAAQ,CAAEC,KAAM,MAAOC,YAAaP,IACtCK,EAAE,IAAK,CAAEC,KAAM,MAAOC,YAAaR,EAAKrC,KAAMqC,OAExCnB,OAAOwB,UAKbK,aAAsB7C,EAAGgC,QAGjC,eApCYZ,EAAS,IArBP,KAuBJ0B,UAAY,KACdD,UAAW,uBAmCI1B,KACfO,sBAAsBC,GAG9B,gBA/Dc,KAiEND,sBAAsBC,IAG9BF,yBACasB,MAAM,WAAWC,SAAUC,EAAEC,WAEhCC,YAAc,uBACdC,UAEAC,iBAAiB,QAASC,KAE5BD,iBAAiB,QAASE,GAGlCC,sBAGYC,kBAAeC,mBAAmBV,YACxCW,YAAarB,EAAEsB"}